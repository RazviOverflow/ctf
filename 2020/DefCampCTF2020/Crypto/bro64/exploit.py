from Crypto.Cipher import Salsa20
import hashlib
from base64 import b64encode, b64decode
from Crypto.Cipher import ChaCha20

print("\n---Salsa20 Decrypt")

key = b"Fidel_Alejandro_Castro_Ruz_Cuba!"

#secret = hashlib.sha256()

#secret.update(key)

print(key)

cipher = Salsa20.new(key=key, nonce=b64decode(b"oM2hBNi0FZQ="))
plaintext = cipher.decrypt(b"ExysX43JnUwTpeoGNVIqqiukRpXOgTFZdKPSoTk7Q2T8oTYUWZyA3B3p22pO2B6huKs/dcjKLtI46wERFAFEjEI99QyN")
print(" Decrypted:\t",plaintext)
'''
cipher = ChaCha20.new(key=secret.digest())
ciphertext = cipher.encrypt(plaintext)


nonce = b64encode(cipher.nonce).decode('utf-8')
ct = b64encode(ciphertext).decode('utf-8')
print("\n---ChaCha20 Encrypt")
print(" Nonce:",nonce)
print(" Cipher:",ct)

print("\n---ChaCha20 Decrypt")
cipher = ChaCha20.new(key=secret.digest(), nonce=cipher.nonce)
plaintext = cipher.decrypt(ciphertext)
print(" Decrypted:\t",plaintext)






# https://asecuritysite.com/encryption/salsa20
from Crypto.Cipher import Salsa20
import hashlib
from base64 import b64encode
from Crypto.Cipher import ChaCha20

plaintext = b'Attack at dawn'
key= b'Test'

print("Plain key:\t",plaintext)
print("Secret key:\t",key)

secret = hashlib.sha256()

secret.update(key)

print("Key used:\t",b64encode(secret.digest()))

cipher = Salsa20.new(key=secret.digest())
enc=cipher.encrypt(plaintext)


ct = b64encode(enc).decode('utf-8')
nonce = b64encode(cipher.nonce).decode('utf-8')
print("\n---Salsa20 Encrypt")
print(" Nonce:",nonce)
print(" Cipher:",ct)


print("\n---Salsa20 Decrypt")
cipher = Salsa20.new(key=secret.digest(), nonce=cipher.nonce)
plaintext = cipher.decrypt(enc)
print(" Decrypted:\t",plaintext)



cipher = ChaCha20.new(key=secret.digest())
ciphertext = cipher.encrypt(plaintext)

nonce = b64encode(cipher.nonce).decode('utf-8')
ct = b64encode(ciphertext).decode('utf-8')
print("\n---ChaCha20 Encrypt")
print(" Nonce:",nonce)
print(" Cipher:",ct)

print("\n---ChaCha20 Decrypt")
cipher = ChaCha20.new(key=secret.digest(), nonce=cipher.nonce)
plaintext = cipher.decrypt(ciphertext)
print(" Decrypted:\t",plaintext)
'''