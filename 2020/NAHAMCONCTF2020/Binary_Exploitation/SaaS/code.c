// RazviOverfwlo

#include <stdio.h>
#include <sys/mman.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>

int main(){

	unsigned long address;
	uint fd;

	address = mmap(0, 4096, PROT_READ | PROT_WRITE, MAP_ANONYMOUS | MAP_SHARED, -1, 0);

	read(0, address, 8); // 0-> stdin. 8 for flag.txt and ommit \n or whatever

	fd = open(address, O_RDONLY);

	read(fd, address, 100);

	write(1, address, 100); // 1 -> stdout

	return 0;
}

/*
mov r9d, 0 ; size_t offset
mov r8d, 0xffffffff ; int fd = 4294967295
mov ecx, 0x21 ; '!' ; int flags
mov edx, 3 ; int prot
mov esi, _init ; 0x1000 ; size_t length
mov edi, 0 ; void*addr
call mmap ; sym.imp.mmap ; void*mmap(void*addr, size_t length, int prot, int flags, int fd, size_t offset)
mov qword [path], rax
mov rax, qword [path]
mov edx, 0x64 ; rdx ; size_t nbyte
mov rsi, rax ; void *buf
mov edi, 0 ; int fildes
call read ; sym.imp.read ; ssize_t read(int fildes, void *buf, size_t nbyte)
mov rax, qword [path]
mov esi, 0 ; int oflag
mov rdi, rax ; const char *path
mov eax, 0
call open ; sym.imp.open ; int open(const char *path, int oflag)
mov dword [fildes], eax
mov rcx, qword [path]
mov eax, dword [fildes]
mov edx, 0x64 ; rdx ; size_t nbyte
mov rsi, rcx ; void *buf
mov edi, eax ; int fildes
call read ; sym.imp.read ; ssize_t read(int fildes, void *buf, size_t nbyte)
mov rax, qword [path]
mov edx, 0x64 ; rdx ; size_t nbytes
mov rsi, rax ; const char *ptr
mov edi, 1 ; int fd
call write ; sym.imp.write ; ssize_t write(int fd, const char *ptr, size_t nbytes)



*/